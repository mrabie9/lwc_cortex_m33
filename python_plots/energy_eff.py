import pandas as pd
import matplotlib.pyplot as plt
from matplotlib import gridspec
import matplotlib.ticker as plticker
import numpy as np
from scipy.stats import norm

# # m7
t = [0.00296, 0.00306, 0.00309, 0.00322, 0.00325, 0.00335, 0.00460, 0.00460, 0.00460, 0.004609319, 0.004636074, 0.00466, 0.00469, 0.004703935, 0.00475, 0.00475, 0.004756445, 0.00487, 0.00538, 0.00547, 0.00709, 0.00710, 0.00711, 0.00717, 0.00718, 0.00727, 0.00789, 0.00794, 0.00902, 0.00913, 0.01147, 0.01177, 0.01214, 0.01233, 0.01378, 0.01393, 0.01486, 0.01500, 0.01517, 0.01520, 0.01680, 0.01719, 0.01724, 0.01727, 0.01740, 0.01759, 0.01762, 0.01763, 0.01766, 0.01774, 0.01781, 0.01788, 0.01810, 0.01823, 0.01853, 0.01901, 0.01902, 0.01905, 0.01918, 0.01929, 0.02174, 0.02222, 0.02333, 0.02343, 0.02391, 0.02392, 0.02411, 0.02413, 0.02505, 0.02530, 0.02561, 0.02618, 0.02676, 0.02682, 0.02749, 0.02751, 0.02800, 0.02803, 0.02893, 0.02893, 0.04864, 0.04871, 0.059974875, 0.06004582, 0.06011, 0.06036, 0.06113, 0.06174, 0.08483, 0.08483, 0.096059814, 0.096061923, 0.10399, 0.10473, 0.11749, 0.11779, 0.120252982, 0.120879166, 0.17304, 0.17336, 0.27987, 0.28045, 0.34410, 0.34478, 0.51023, 0.51107, 0.77524, 0.77623, 2.33131, 2.33140, 2.57651, 2.57702, 3.00200, 3.00991, 3.21188, 3.21363, 3.60900, 3.63616, 4.04342, 4.04370, 5.14728, 5.14739, 5.36206, 5.36241, 5.72862, 5.72864]
r_e= [0.00093, 0.00096, 0.00098, 0.00099, 0.00101, 0.00103, 0.00139, 0.00147, 0.00147, 0.00138, 0.00139, 0.0014, 0.00149, 0.00139, 0.0015, 0.00149, 0.00141, 0.00154, 0.00169, 0.00171, 0.00213, 0.00213, 0.00214, 0.00214, 0.00214, 0.00216, 0.00248, 0.00247, 0.00277, 0.00281, 0.00354, 0.00355, 0.00377, 0.00374, 0.00422, 0.00422, 0.00447, 0.00488, 0.00489, 0.00446, 0.0051, 0.0051, 0.00526, 0.00514, 0.0054, 0.00546, 0.00545, 0.00545, 0.0053, 0.0053, 0.00536, 0.00534, 0.00558, 0.00557, 0.0056, 0.00574, 0.00562, 0.00575, 0.00595, 0.00591, 0.00681, 0.00691, 0.00694, 0.00699, 0.00715, 0.00718, 0.00724, 0.00719, 0.00807, 0.00813, 0.00771, 0.00786, 0.00841, 0.00843, 0.00832, 0.00829, 0.00846, 0.00848, 0.00885, 0.00885, 0.01477, 0.01477, 0.01824, 0.01832, 0.01876, 0.01809, 0.01807, 0.01878, 0.02573, 0.02574, 0.02922, 0.02924, 0.03174, 0.032, 0.03553, 0.03562, 0.03665, 0.03691, 0.04847, 0.04854, 0.08413, 0.08426, 0.10148, 0.10163, 0.14292, 0.14311, 0.23091, 0.23123, 0.72765, 0.72829, 0.75412, 0.7542, 0.75034, 0.74879, 0.82704, 0.82766, 0.91833, 0.92743, 1.2512, 1.25302, 1.5276, 1.50627, 1.55475, 1.55738, 1.72772, 1.72563]
# # r_e = [0.010849755, 0.010850593, 0.01085044, 0.010850486, 0.010850449, 0.010850648, 0.010850486, 0.010850759, 0.010850454, 0.010850588, 0.010850412, 0.010850584, 0.010850518, 0.010850356, 0.010851013, 0.010850764, 0.01085044, 0.010850704, 0.010850537, 0.010850949]

# # normalise
min_val = np.min(t)
max_val = np.max(t)
t_n = (t - min_val) / (max_val - min_val)

# # # m4
t4 = [0.011055025, 0.011055512, 0.011172725, 0.011172975, 0.011268362, 0.011301513, 0.01567645, 0.016066125, 0.016241513, 0.016828651, 0.016870251, 0.016985251, 0.017007487, 0.017105475, 0.017150262, 0.017213738, 0.017237375, 0.017433651, 0.017433938, 0.017546151, 0.017546687, 0.017575063, 0.0175932, 0.017632175, 0.020513762, 0.020560788, 0.0208958, 0.021146262, 0.021412387, 0.021538476, 0.023025399, 0.023913588, 0.024087137, 0.024124375, 0.024125125, 0.024163213, 0.026041038, 0.026109312, 0.026190313, 0.026228474, 0.026316913, 0.026353063, 0.026409401, 0.0264473, 0.026654638, 0.026785662, 0.027518112, 0.0275183, 0.030945949, 0.031151662, 0.03169265, 0.031870998, 0.031983789, 0.032001425, 0.032073412, 0.032695226, 0.035457637, 0.035550062, 0.039227575, 0.0393029, 0.045088187, 0.045125451, 0.064666174, 0.064667813, 0.065041386, 0.06504301, 0.073727913, 0.073919773, 0.08146631, 0.081468999, 0.082388535, 0.082473248, 0.089644328, 0.089645959, 0.089986451, 0.089987591, 0.094075426, 0.094117187, 0.094242565, 0.094307654, 0.094329551, 0.094362028, 0.098552473, 0.098554537, 0.124108046, 0.124110572, 0.141810045, 0.141810745, 0.146931782, 0.146933496, 0.170529127, 0.170557126, 0.382664114, 0.382925689, 0.402766585, 0.402811915, 0.408786386, 0.408901989, 0.45756191, 0.457579464, 0.568699479, 0.569688916, 0.690779686, 0.692019463, 2.565379381, 2.565973282, 3.542793512, 3.542793512, 4.144080639, 4.162874699, 4.357792854, 4.382277966, 4.555865765, 4.556022167, 4.82263422, 4.845128536, 4.974661827, 4.974852562, 5.239318371, 5.239320278, 7.231687069, 7.23169136]
r_e4= [0.0005, 0.0005, 0.00051, 0.00051, 0.00051, 0.00051, 0.0008, 0.00078, 0.00083, 0.00082, 0.00086, 0.00078, 0.00078, 0.00079, 0.00079, 0.00079, 0.00079, 0.00076, 0.00076, 0.00077, 0.00077, 0.00077, 0.00078, 0.00088, 0.00095, 0.00094, 0.00108, 0.00096, 0.0011, 0.00098, 0.00117, 0.00119, 0.0011, 0.00111, 0.00112, 0.00112, 0.00118, 0.00119, 0.00121, 0.00123, 0.00115, 0.00115, 0.00116, 0.00116, 0.00118, 0.00118, 0.00126, 0.00128, 0.00141, 0.00141, 0.0016, 0.00146, 0.00142, 0.00154, 0.00165, 0.00156, 0.00161, 0.00161, 0.00183, 0.00185, 0.00211, 0.00214, 0.00285, 0.00282, 0.00287, 0.00286, 0.00363, 0.00366, 0.00375, 0.00373, 0.00382, 0.00386, 0.00393, 0.00391, 0.00396, 0.00394, 0.00417, 0.00418, 0.00413, 0.00414, 0.0042, 0.00416, 0.00453, 0.0045, 0.00563, 0.0056, 0.00642, 0.00639, 0.0068, 0.00675, 0.00788, 0.00784, 0.01784, 0.01774, 0.01678, 0.0167, 0.01728, 0.01721, 0.01964, 0.01969, 0.02724, 0.02716, 0.0329, 0.03281, 0.10672, 0.10736, 0.16717, 0.16636, 0.22693, 0.22889, 0.23837, 0.24011, 0.19424, 0.19355, 0.2625, 0.26442, 0.21159, 0.21101, 0.23642, 0.2376, 0.31513, 0.31444]

min_val = np.min(t4)
max_val = np.max(t4)
t4_n = (t4 - min_val) / (max_val - min_val)

# # # m33
t33 = [0.002515575, 0.002518319, 0.002608269, 0.002610087, 0.002615925, 0.002619162, 0.003127006, 0.00312715, 0.00315, 0.003145962, 0.003178375, 0.00318, 0.00404, 0.004036687, 0.004055206, 0.004059025, 0.00407, 0.004079644, 0.004730375, 0.004730431, 0.004743919, 0.00476245, 0.0047628, 0.004796, 0.005285694, 0.005378506, 0.007035512, 0.007160319, 0.007278656, 0.007333781, 0.00767, 0.00786, 0.00790, 0.00792, 0.008095982, 0.008392656, 0.00965, 0.009760094, 0.00994, 0.009960937, 0.010017775, 0.010116606, 0.01059545, 0.010845781, 0.011322825, 0.011615006, 0.011916981, 0.011922725, 0.011994794, 0.012000212, 0.01202, 0.012040475, 0.012059481, 0.01208, 0.012195612, 0.012200925, 0.01346, 0.01358, 0.014068931, 0.014087687, 0.014111556, 0.014262293, 0.015987169, 0.015987569, 0.016163962, 0.016171519, 0.016241781, 0.016248925, 0.016478056, 0.016485356, 0.01959, 0.01965, 0.022633532, 0.022652013, 0.023238899, 0.023243099, 0.023254074, 0.023257799, 0.023306288, 0.023430081, 0.038309913, 0.038311161, 0.038953651, 0.039094839, 0.041208442, 0.041349757, 0.048926793, 0.04892778, 0.057401475, 0.057402343, 0.068239398, 0.068240084, 0.071039341, 0.071039997, 0.083204515, 0.083204962, 0.094804101, 0.094856881, 0.106335439, 0.106491975, 0.20182851, 0.201855898, 0.211238906, 0.2112398, 0.283214152, 0.283409268, 0.345261037, 0.345673114, 1.23104, 1.23116, 1.957111955, 1.957113385, 2.09854, 2.09854, 2.36052, 2.36053, 2.738874912, 2.751074314, 2.858740091, 2.86677742, 3.021113634, 3.021114349, 3.091006517, 3.099936247, 3.700358868, 3.700359106]
r_e33= [0.00007, 0.00007, 0.00007, 0.00007, 0.00007, 0.00007, 0.00008, 0.00008, 0.00008, 0.00008, 0.00008, 0.00008, 0.00011, 0.00011, 0.00011, 0.00012, 0.00011, 0.00012, 0.00012, 0.00012, 0.00012, 0.00012, 0.00012, 0.00012, 0.00015, 0.00015, 0.00021, 0.0002, 0.00021, 0.0002, 0.00023, 0.00022, 0.00024, 0.00022, 0.00024, 0.00025, 0.00026, 0.00029, 0.00027, 0.0003, 0.00028, 0.00029, 0.00032, 0.00033, 0.00034, 0.00035, 0.00031, 0.0003, 0.00031, 0.00031, 0.00033, 0.00033, 0.00033, 0.00033, 0.00031, 0.00031, 0.00038, 0.00039, 0.00039, 0.00038, 0.00045, 0.00046, 0.00042, 0.00042, 0.00041, 0.00041, 0.00042, 0.00042, 0.00042, 0.00042, 0.00055, 0.00055, 0.00065, 0.00064, 0.0006, 0.00061, 0.0006, 0.0006, 0.00061, 0.00061, 0.00106, 0.00106, 0.00114, 0.00114, 0.00117, 0.00117, 0.00135, 0.00135, 0.00157, 0.00157, 0.00187, 0.00187, 0.00199, 0.00198, 0.00233, 0.00231, 0.0024, 0.0024, 0.00309, 0.00311, 0.00508, 0.00508, 0.00532, 0.0053, 0.0082, 0.00821, 0.00987, 0.00987, 0.03199, 0.03192, 0.05412, 0.05419, 0.05447, 0.05448, 0.06043, 0.06066, 0.08327, 0.08364, 0.08727, 0.08659, 0.08218, 0.08238, 0.09416, 0.09446, 0.09642, 0.09619]

min_val = np.min(t33)
max_val = np.max(t33)
t33_n = (t33 - min_val) / (max_val - min_val)

# convert to mJ
r_e = np.array(r_e)*1e3
r_e4 = np.array(r_e4) *1e3
r_e33 = np.array(r_e33)*1e3

g_m7 = 1506.34/0.8985
m7_y = g_m7*t_n

g_m4 = 127/0.398
m4_y = g_m4*t4_n

g_m33 = 39/0.3984
m33_y = g_m33*t33_n

print("M7 Average Energy:", round(np.mean(r_e), 2), "Gradient: ", g_m7)
print("M4 Average Energy:", round(np.mean(r_e4), 2), "Gradient: ", g_m4)
print("M33 Average Energy:", round(np.mean(r_e33), 2), "Gradient: ", g_m33)

colors = ["#000080", "skyblue", "#1e90ff", "#87cefa"]
plt.plot(t_n, r_e, color=colors[0], label='M7')
plt.plot(t4_n, r_e4, color=colors[1], label='M4')
plt.plot(t33_n, r_e33, color=colors[2], label='M33')
plt.plot(t_n, m7_y, color=colors[0], label='M7 linear approximation', linestyle='--',linewidth=1.5)
plt.plot(t4_n, m4_y, color=colors[1], label='M4 linear approximation', linestyle='--',linewidth=1.5)
plt.plot(t33_n, m33_y, color=colors[2], label='M33 linear approximation', linestyle='--',linewidth=1.5)

# plt.xscale("log")
plt.grid(axis='y', alpha=0.4)
plt.ylabel('Average energy consumption (mJ)', fontsize=11)
plt.xlabel('Normalised time (s)', fontsize=11)
plt.subplots_adjust(left = 0.1, right = 0.98, top=0.96, wspace=0.9, bottom=0.1)
plt.legend(loc='upper left')
plt.show()